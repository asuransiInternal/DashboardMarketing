<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Daftar - Dashboard Marketing</title>
  <link rel="stylesheet" href="assets/css/style.css"/>
  <script src="assets/js/config.js"></script>
  <script src="assets/js/auth.js"></script>
  <script src="auth.js"></script>
</head>
<body>
  <div class="container">
    <div class="left">
      <div class="bg" id="leftBg">
        <div class="overlay"></div>
        <div class="hero">
          <div style="font-size:13px; opacity:0.9; margin-bottom:18px;">Dashboard Marketing</div>
          <h1>Monitoring<br/>Marketing Menjadi Mudah</h1>
          <p style="margin-top:18px; font-size:15px; max-width:420px;">
            Monitoring bisnis Marketing secara real-time dengan data yang akurat dan terpusat.
          </p>
        </div>
      </div>
    </div>

    <div class="right">
      <h2 style="margin:0 0 8px">Buat Akun Baru</h2>
      <p class="small" style="margin-top:0;margin-bottom:18px;">Isi data di bawah ini untuk mendaftar.</p>

      <div class="form-group">
        <label>Nama Lengkap</label>
        <input id="nama" class="input" />
      </div>
      <div class="form-group">
        <label>Email (Wajib Gmail)</label>
        <input id="email" type="email" class="input" placeholder="contoh: namaanda@gmail.com" />
      </div>
      <div class="form-group">
        <label>Password</label>
        <input id="password" type="password" class="input" placeholder="Buat password yang kuat" />
      </div>
      <div class="form-group">
        <label>No. WhatsApp</label>
        <input id="wa" class="input" placeholder="Contoh: 081234567890" />
      </div>

      <button class="btn" id="btnSignup">DAFTAR</button>

      <div id="signupMsg" class="signup-msg small" style="color:#6b7280"></div>
      <div style="margin-top:18px; text-align:center" class="small">Sudah punya akun? <a href="index.html">Masuk di sini</a></div>
    </div>
  </div>

  <div class="toast-wrap"></div>

  <script>
    document.getElementById('leftBg').style.backgroundImage = "url('https://raw.githubusercontent.com/asuransiInternal/DashboardMarketing/main/file_000000006878722fb57ff4d6cf3e6877.png')";

    async function doSignup(){
      const nama = (document.getElementById('nama').value||'').trim();
      const email = (document.getElementById('email').value||'').trim();
      const password = (document.getElementById('password').value||'').trim();
      const wa = (document.getElementById('wa').value||'').trim();
      const msgEl = document.getElementById('signupMsg');

      if(!nama || !email || !password){ msgEl.innerText = 'Lengkapi semua isian'; msgEl.style.color='#c53030'; return; }
      if(!email.endsWith('@gmail.com')){ msgEl.innerText = 'Gunakan alamat Gmail'; msgEl.style.color='#c53030'; return; }
      if(password.length < 6){ msgEl.innerText = 'Password minimal 6 karakter'; msgEl.style.color='#c53030'; return; }

      const clientHash = await sha256hex(password);
      const res = await apiGet('signup', { nama_lengkap: nama, email: email, client_hash: clientHash, no_whatsapp: wa });
      if(res.status === 'ok'){
        msgEl.innerText = res.message || 'Permintaan pendaftaran diterima, menunggu approval Admin';
        msgEl.style.color = '#15803d';
        toast('Pendaftaran terkirim');
      } else {
        msgEl.innerText = res.message || 'Gagal mendaftar';
        msgEl.style.color = '#c53030';
      }
    }

    document.getElementById('btnSignup').addEventListener('click', doSignup);
  </script>
</body>
</html>
